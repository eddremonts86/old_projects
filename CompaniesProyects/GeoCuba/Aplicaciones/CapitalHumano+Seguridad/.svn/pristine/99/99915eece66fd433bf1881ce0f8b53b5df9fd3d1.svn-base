// Function definition
function AddRol()
{
	this._btn = null;

	this.Render = function(Panel)
	{
		this._btn = Ext.create('Ext.Button',
		{
			text: 'Adicionar',
			id: 'add_rol_btn_id',
			iconCls: 'add',
			handler: Ext.Function.bind(this.Owner.OnAdd, this.Owner)
		});

		var tbar = Ext.getCmp('rols_tbar_id');
		tbar.add(this._btn);
		tbar.add(' ');
		tbar.add('-');
	}

	this.Enable = function()
	{
		this._btn.enable();
	}

	this.Disable = function()
	{
		this._btn.disable();
	}
}

App.RegisterFunction('AddRol', new AddRol());

// Module funcions definition
AdminRols.prototype.OnAdd = function()
{
	var _add_panel = new Ext.form.Panel(
	{
		border: true,
		frame: true,
		width: '100%',
		height: '100%',
		id: '_add_rol_panel_id',
		defaults: {width: 300},
		items:
		[
			{
				xtype: "textfield",
				fieldLabel: "Nombre",
				name: "rol_name",
				allowBlank: false
			},
			{
				xtype: "textfield",
				fieldLabel: "Descripci√≥n",
				name: "rol_description",
				allowBlank: false
			}
		]
	});

	var _add_win = new Ext.Window(
	{
		title: 'Nuevo rol',
		id: '_add_rol_win_id',
		height: 150,
		width: 330,
		plain: true,
		closable: false,
		layout: 'fit',
		modal: true,
		resizable: false,
		items: [_add_panel],
		buttons:
		[
			{
			    text:'Adicionar',
			    handler : this.AddRol,
			    scope: this
			},
			{
			    text: 'Cerrar',
			    handler: function(){_add_win.close();}
			}
		]
	});

	_add_win.show();
}

AdminRols.prototype.AddRol = function()
{
	var _form = Ext.getCmp('_add_rol_panel_id').getForm();

	if(_form.isValid())
	{
        App.ShowMsgBox(Ext.Msg.wait('Por favor, espere un momento','Procesando...'));
        var result = App.PerformSyncServerRequest('RolsManager.RolsManager.CreateRol', _form.getValues());
        App.HideMsgBox();
          
        if(result)
        {
            _form.reset();
            this.__data_store.load();
        }
	}
}